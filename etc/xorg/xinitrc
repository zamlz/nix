# Setup the logger
. $HOME/lib/shell/logging && eval "$(get_logger etc.xorg.xinitrc)"

# Some linux distros have predefined scripts in these locations that
# need to be sourced in order for proper Xorg operation. Source the
# global defaults and then the local files if any exist.

logger "Sourcing xinitrc.d files if they exist"
if [ -d /etc/X11/xinit/xinitrc.d ] ; then
    for f in /etc/X11/xinit/xinitrc.d/*.sh ; do
        [ -x "$f" ] && . "$f"
    done
    unset f
fi

logger "Source local user-defined xinitrc.d files if they exist"
if [ -d $HOME/etc/xorg/scripts ] ; then
    find "$HOME/etc/xorg/scripts" -name "*.sh" | while read -r f; do
        [ -x "$f" ] && . "$f"
    done
    unset f
fi

# This part of the script decides which window manager to start. This is
# ultimately passed as an argument to starx. It is configured from $1 which
# must be passed to it. Currently we have options to trigger the Herbstluftwm
# Tiling Window Manager.

session=${1:-herbstluftwm}
logger "Starting session: $session"

case $session in
    herbstluftwm)   exec herbstluftwm;;
    *)              exec $1;;
esac


